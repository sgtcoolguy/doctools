Ext.data.JsonP['Properties_Sync_Adaptor']({"guide":"<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n        \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n    <title>Properties Sync Adaptor</title>\n\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n    <meta content=\"Scroll EclipseHelp Exporter\" name=\"generator\">\n\n    <link type=\"text/css\" rel=\"stylesheet\">\n    <link type=\"text/css\" rel=\"stylesheet\">\n    <link type=\"text/css\" rel=\"stylesheet\" media=\"print\">\n</link></link></link></meta></meta></head>\n<body>\n    <div class=\"container\">\n\t\t<div id=\"banner\" class=\"confbox admonition admonition-note aui-message warning shadowed information-macro\">\n\t\t\t<p>You can now find Appcelerator documentation at <a href=\"https://docs.axway.com/\" target=\"_blank\">https://docs.axway.com/</a>. This site will be taken down in the near future.</p></div>\n        <div class=\"header\"/>\n\n        <div id=\"src-41845721\" class=\"content\">\n                        <h1>Properties Sync Adaptor</h1>\n    <p>Demonstrates using Alloy&apos;s Titanium.App.Properties sync adaptor to save data.    </p>\n    <div class=\"confbox admonition admonition-info aui-message hint shadowed information-macro has-no-icon\">\n            <div class=\"title\">App Folder Location</div>\n            <p>alloy/test/apps/<strong class=\" \">models/properties</strong>    </p>\n    </div>\n        <p>The sample presents two tabs: Model and Collection. The modelTab.xml view provides buttons to create or destroy an instance of a model, and increment one a numeric model fields. The Collection tab provides UI to add items to a collection, which is bound to a TableView. Clicking a table row updates a field in the corresponding collection item. Long-pressing a table row deletes the corresponding item from the collection.    </p>\n    <p>    <img src=\"images/download/attachments/41845721/propertie_sync.png\" alt=\"images/download/attachments/41845721/propertie_sync.png\" class=\"confluence-embedded-image\">\n        </img></p>\n    <p>The application includes two model configuration files, one used by each tab view. Note that the adaptor type in each configuration file is set to &quot;properties&quot;.    </p>\n    <div class=\"confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code\">\n                    <div class=\"title\">app/models/modelTab.js</div>\n                <div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"defaultnew syntaxhighlighter scroll-html-formatted-code\" data-title=\"app/models/modelTab.js\">\n<div class=\"line\"><code class=\"plain\">exports.definition = {</code></div>\n<div class=\"line\"><code class=\"plain\">    config: {</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"string\">&quot;columns&quot;</code><code class=\"plain\">: {</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;id&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;String&quot;</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;count&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;Int&quot;</code></div>\n<div class=\"line\"><code class=\"plain\">        },</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"string\">&quot;defaults&quot;</code><code class=\"plain\">: {</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;id&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;foobar&quot;</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;count&quot;</code><code class=\"plain\">: </code><code class=\"value\">0</code></div>\n<div class=\"line\"><code class=\"plain\">        },</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"string\">&quot;adapter&quot;</code><code class=\"plain\">: {</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;type&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;properties&quot;</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;collection_name&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;singleModel&quot;</code></div>\n<div class=\"line\"><code class=\"plain\">        }</code></div>\n<div class=\"line\"><code class=\"plain\">    }</code></div>\n<div class=\"line\"><code class=\"plain\">};</code></div>\n</div>\n    </div>\n    <div class=\"confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code\">\n                    <div class=\"title\">app/models/collectionTab.js</div>\n                <div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"defaultnew syntaxhighlighter scroll-html-formatted-code\" data-title=\"app/models/collectionTab.js\">\n<div class=\"line\"><code class=\"plain\">exports.definition = {</code></div>\n<div class=\"line\"><code class=\"plain\">    config: {</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"string\">&quot;columns&quot;</code><code class=\"plain\">: {</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;name&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;String&quot;</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;score&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;Int&quot;</code></div>\n<div class=\"line\"><code class=\"plain\">        },</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"string\">&quot;defaults&quot;</code><code class=\"plain\">: {</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;name&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;&lt;no name&gt;&quot;</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;score&quot;</code><code class=\"plain\">: </code><code class=\"value\">0</code></div>\n<div class=\"line\"><code class=\"plain\">        },</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"string\">&quot;adapter&quot;</code><code class=\"plain\">: {</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;type&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;properties&quot;</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"string\">&quot;collection_name&quot;</code><code class=\"plain\">: </code><code class=\"string\">&quot;collection&quot;</code></div>\n<div class=\"line\"><code class=\"plain\">        }</code></div>\n<div class=\"line\"><code class=\"plain\">    }</code></div>\n<div class=\"line\"><code class=\"plain\">};</code></div>\n</div>\n    </div>\n    <p>The modelTab.js view-controller creates an instance of the <strong class=\" \">modelTab</strong> model, and binds a callback function to the <tt class=\" \">change</tt> event on the <tt class=\" \">count</tt> field, which updates the label in the corresponding view with a JSON representation of the model&apos;s <a class=\"external-link external-link\" href=\"http://backbonejs.org/#Model-attributes\" target=\"_blank\">attributes</a>. The same handler responds to model <tt class=\" \">fetch</tt> events. It also defined event handlers for the Create, Destroy, and Increment buttons defined the app/views/modelTab.xml file (not shown).    </p>\n    <div class=\"confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code\">\n                    <div class=\"title\">app/controllers/modelTab.js</div>\n                <div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"defaultnew syntaxhighlighter scroll-html-formatted-code\" data-title=\"app/controllers/modelTab.js\">\n<div class=\"line\"><code class=\"plain\">var ID = </code><code class=\"string\">&apos;instance&apos;</code><code class=\"plain\">;</code></div>\n<div class=\"line\"><code class=\"plain\">var app = Alloy.createModel(</code><code class=\"string\">&apos;modelTab&apos;</code><code class=\"plain\">);</code></div>\n<div class=\"line\">&#xA0;</div>\n<div class=\"line\"><code class=\"comments\">// Change label when &apos;count&apos; changes on model</code></div>\n<div class=\"line\"><code class=\"plain\">app.on(</code><code class=\"string\">&apos;fetch change:count&apos;</code><code class=\"plain\">, function(model) {</code></div>\n<div class=\"line\"><code class=\"plain\">\t$.label.text = </code><code class=\"string\">&apos;model: &apos;</code><code class=\"plain\"> + JSON.stringify(app.attributes);</code></div>\n<div class=\"line\"><code class=\"plain\">});</code></div>\n<div class=\"line\"><code class=\"comments\">// fetch model from Ti.App.Properties adapter</code></div>\n<div class=\"line\"><code class=\"plain\">app.set(</code><code class=\"string\">&apos;id&apos;</code><code class=\"plain\">, ID);</code></div>\n<div class=\"line\"><code class=\"plain\">app.fetch();</code></div>\n<div class=\"line\">&#xA0;</div>\n<div class=\"line\"><code class=\"comments\">// event handlers</code></div>\n<div class=\"line\"><code class=\"plain\">function create(e) {</code></div>\n<div class=\"line\"><code class=\"plain\">\tapp.save(app.defaults);</code></div>\n<div class=\"line\"><code class=\"plain\">}</code></div>\n<div class=\"line\"><code class=\"plain\">function destroy(e) {</code></div>\n<div class=\"line\"><code class=\"plain\">\tapp.destroy();</code></div>\n<div class=\"line\"><code class=\"plain\">}</code></div>\n<div class=\"line\"><code class=\"plain\">function increment(e) {</code></div>\n<div class=\"line\"><code class=\"plain\">\tapp.set({</code></div>\n<div class=\"line\"><code class=\"plain\">\t\tcount: app.get(</code><code class=\"string\">&apos;count&apos;</code><code class=\"plain\">)+</code><code class=\"value\">1</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">\t\tid: ID</code></div>\n<div class=\"line\"><code class=\"plain\">\t});</code></div>\n<div class=\"line\"><code class=\"plain\">\tapp.save();</code></div>\n<div class=\"line\"><code class=\"plain\">}</code></div>\n</div>\n    </div>\n    <p>The Collection tab provides UI to add items to the collection, which is bound to the <tt class=\" \">TableView</tt> element&apos;s <tt class=\" \">dataCollection</tt> attribute. Clicking a table row updates the corresponding collection item&apos;s &quot;score&quot; field, which is displayed in the row. Whenever a model is added or destroyed (by long-pressing on a TableView row), the new collection data is fetched, which fires the <tt class=\" \">fetch</tt> event. The <tt class=\" \">resetTableData()</tt> function re-populates the TableView with new instances of the <strong class=\" \">controllers/collection/row.js</strong> controller, passing each the ID, name, and score to display.    </p>\n    <div class=\"confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code\">\n                    <div class=\"title\">app/controllers/collection/collectionTab.js</div>\n                <div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"defaultnew syntaxhighlighter scroll-html-formatted-code\" data-title=\"app/controllers/collection/collectionTab.js\">\n<div class=\"line\"><code class=\"plain\">var items = Alloy.createCollection(</code><code class=\"string\">&apos;collectionTab&apos;</code><code class=\"plain\">),</code></div>\n<div class=\"line\"><code class=\"plain\">    rowControllers = [];</code></div>\n<div class=\"line\"><code class=\"comments\">// update the row and save the model when the score changes</code></div>\n<div class=\"line\"><code class=\"plain\">items.on(</code><code class=\"string\">&apos;change:score&apos;</code><code class=\"plain\">, function(model) {</code></div>\n<div class=\"line\"><code class=\"plain\">    </code><code class=\"keyword\">if</code><code class=\"plain\"> (model) {</code></div>\n<div class=\"line\"><code class=\"plain\">        var row = _.find(rowControllers, function(r) {</code></div>\n<div class=\"line\"><code class=\"plain\">            </code><code class=\"keyword\">return</code><code class=\"plain\"> r.id === model.id;</code></div>\n<div class=\"line\"><code class=\"plain\">        });</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"keyword\">if</code><code class=\"plain\"> (row) {</code></div>\n<div class=\"line\"><code class=\"plain\">            row.score.text = model.get(</code><code class=\"string\">&apos;score&apos;</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">            model.save();</code></div>\n<div class=\"line\"><code class=\"plain\">        }</code></div>\n<div class=\"line\"><code class=\"plain\">    }</code></div>\n<div class=\"line\"><code class=\"plain\">});</code></div>\n<div class=\"line\"><code class=\"comments\">// reset the table whenever a model is added or destroyed</code></div>\n<div class=\"line\"><code class=\"comments\">// completely. Also reset whenever the collection is reset.</code></div>\n<div class=\"line\"><code class=\"comments\">// Save the model changes if necessary.</code></div>\n<div class=\"line\"><code class=\"plain\">items.on(</code><code class=\"string\">&apos;fetch&apos;</code><code class=\"plain\">, function(model) {</code></div>\n<div class=\"line\"><code class=\"plain\">    resetTableData();</code></div>\n<div class=\"line\"><code class=\"plain\">});</code></div>\n<div class=\"line\"><code class=\"comments\">// fetch collection from Ti.App.Properties adapter</code></div>\n<div class=\"line\"><code class=\"plain\">items.fetch();</code></div>\n<div class=\"line\"><code class=\"comments\">//////////////////////////////////////</code></div>\n<div class=\"line\"><code class=\"comments\">////////// private function //////////</code></div>\n<div class=\"line\"><code class=\"comments\">//////////////////////////////////////</code></div>\n<div class=\"line\"><code class=\"plain\">function resetTableData() {</code></div>\n<div class=\"line\"><code class=\"plain\">    rowControllers = [];</code></div>\n<div class=\"line\"><code class=\"plain\">    </code><code class=\"comments\">// create row controllers based on all models in the collection</code></div>\n<div class=\"line\"><code class=\"plain\">    _.each(items.toJSON(), function(i) {</code></div>\n<div class=\"line\"><code class=\"plain\">        rowControllers.push(Alloy.createController(</code><code class=\"string\">&apos;collection/row&apos;</code><code class=\"plain\">, {</code></div>\n<div class=\"line\"><code class=\"plain\">            id: i.id,</code></div>\n<div class=\"line\"><code class=\"plain\">            name: i.name,</code></div>\n<div class=\"line\"><code class=\"plain\">            score: i.score</code></div>\n<div class=\"line\"><code class=\"plain\">        }));</code></div>\n<div class=\"line\"><code class=\"plain\">    });</code></div>\n<div class=\"line\"><code class=\"plain\">    </code><code class=\"comments\">// fill table with the controllers&apos; TableViewRow, and sort</code></div>\n<div class=\"line\"><code class=\"plain\">    </code><code class=\"comments\">// by the row&apos;s ID</code></div>\n<div class=\"line\"><code class=\"plain\">    var theArray = _.sortBy(rowControllers, function(r) {</code></div>\n<div class=\"line\"><code class=\"plain\">        </code><code class=\"keyword\">return</code><code class=\"plain\"> r.getView(</code><code class=\"string\">&apos;name&apos;</code><code class=\"plain\">).text;</code></div>\n<div class=\"line\"><code class=\"plain\">    });</code></div>\n<div class=\"line\"><code class=\"plain\">    $.table.setData(_.map(theArray, function(r) {</code><code class=\"keyword\">return</code><code class=\"plain\"> r.getView();}));</code></div>\n<div class=\"line\"><code class=\"plain\">}</code></div>\n<div class=\"line\"><code class=\"comments\">////////////////////////////////////</code></div>\n<div class=\"line\"><code class=\"comments\">////////// event handlers //////////</code></div>\n<div class=\"line\"><code class=\"comments\">////////////////////////////////////</code></div>\n<div class=\"line\"><code class=\"plain\">function deleteItem(e) {</code></div>\n<div class=\"line\"><code class=\"plain\">    var model = items.get(e.row.id);</code></div>\n<div class=\"line\"><code class=\"plain\">    </code><code class=\"keyword\">if</code><code class=\"plain\"> (model) {</code></div>\n<div class=\"line\"><code class=\"plain\">        model.destroy();</code></div>\n<div class=\"line\"><code class=\"plain\">    }</code></div>\n<div class=\"line\"><code class=\"plain\">    items.fetch();</code></div>\n<div class=\"line\"><code class=\"plain\">}</code></div>\n<div class=\"line\"><code class=\"plain\">function incrementScore(e) {</code></div>\n<div class=\"line\"><code class=\"plain\">    var model = items.get(e.row.id);</code></div>\n<div class=\"line\"><code class=\"plain\">    </code><code class=\"keyword\">if</code><code class=\"plain\"> (model) {</code></div>\n<div class=\"line\"><code class=\"plain\">        model.set(</code><code class=\"string\">&apos;score&apos;</code><code class=\"plain\">, model.get(</code><code class=\"string\">&apos;score&apos;</code><code class=\"plain\">)+</code><code class=\"value\">1</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">    }</code></div>\n<div class=\"line\"><code class=\"plain\">}</code></div>\n<div class=\"line\"><code class=\"plain\">function addItem(e) {</code></div>\n<div class=\"line\"><code class=\"plain\">    var model = items.create({</code></div>\n<div class=\"line\"><code class=\"plain\">        name: $.text.value || </code><code class=\"string\">&apos;&lt;no name&gt;&apos;</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">        score: </code><code class=\"value\">0</code></div>\n<div class=\"line\"><code class=\"plain\">    });</code></div>\n<div class=\"line\"><code class=\"plain\">    items.add(model);</code></div>\n<div class=\"line\"><code class=\"plain\">    items.fetch();</code></div>\n<div class=\"line\"><code class=\"plain\">    $.text.value = </code><code class=\"string\">&apos;&apos;</code><code class=\"plain\">;</code></div>\n<div class=\"line\"><code class=\"plain\">}</code></div>\n</div>\n    </div>\n    <div class=\"section section-2 \" id=\"src-41845721_PropertiesSyncAdaptor-SeeAlso\">\n        <h2 class=\"heading \"><span>See Also</span></h2>\n<ul class=\" \"><li class=\" \">    <p><a class=\"document-link unresolved\" href=\"#!/guide/Properties_Sync_Adaptor-section-src-41845721\">Sync Adapters</a>    </p>\n</li><li class=\" \">    <p><a class=\"external-link \" href=\"https://wiki.appcelerator.org/display/guides2/New+-+Alloy+Collection+and+Model+Objects\">Alloy Collection and Model Objects</a>    </p>\n</li></ul>    <p>    </p>\n    </div>\n        </div><a id=\"editButton\" href=\"https://wiki.appcelerator.org/pages/editpage.action?pageId=41845721\"><span>Edit</span></a>\n    \n        \n    </div>\n</body>\n</html>\n","title":"Properties Sync Adaptor"});