<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>AMPLIFY Appcelerator Platform Services SDK for iOS Mobile Backend Services</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="Scroll EclipseHelp Exporter" name="generator">

    <link type="text/css" rel="stylesheet">
    <link type="text/css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" media="print">
</link></link></link></meta></meta></head>
<body>
    <div class="container">
        <div class="header"/>

        <div id="src-49153770" class="content">
                        <h1>AMPLIFY Appcelerator Platform Services SDK for iOS Mobile Backend Services</h1>
    <p>    </p>
<ul class="toc-indentation "><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-GettingtheSDK">Getting the SDK</a>    </p>
</li><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-RunningtheAPSCloudExampleapplication">Running the APSCloud Example application</a>    </p>
</li><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-EnablingCloudservicesinanewproject">Enabling Cloud services in a new project</a>    </p>
</li><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-MakingAPIcallsandhandlingresponses">Making API calls and handling responses</a>    </p>
<ul class="toc-indentation "><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Buildingrequestparameters">Building request parameters</a>    </p>
</li><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Handlingresponses">Handling responses</a>    </p>
<ul class="toc-indentation "><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_safe-id-QU1QTElGWUFwcGNlbGVyYXRvclBsYXRmb3JtU2VydmljZXNTREtmb3JpT1NNb2JpbGVCYWNrZW5kU2VydmljZXMtRXhhbXBsZTpBUFNVc2Vyc2xvZ2luY2FsbHdpdGhyZXNwb25zZWhhbmRsZXI">Example: APSUsers login call with response handler</a>    </p>
</li></ul></li><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Monitoringrequestprogress">Monitoring request progress</a>    </p>
<ul class="toc-indentation "><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_safe-id-QU1QTElGWUFwcGNlbGVyYXRvclBsYXRmb3JtU2VydmljZXNTREtmb3JpT1NNb2JpbGVCYWNrZW5kU2VydmljZXMtRXhhbXBsZTpBUFNQaG90b3NjcmVhdGVjYWxsd2l0aHByb2dyZXNzaGFuZGxlcg">Example: APSPhotos create call with progress handler</a>    </p>
</li></ul></li></ul></li><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-MakinggenericRESTAPIsmethodcalls">Making generic REST APIs method calls</a>    </p>
</li><li class=" ">    <p><a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Workingwithpushnotifications">Working with push notifications</a>    </p>
</li></ul>    <p>The AMPLIFY Appcelerator Platform Services SDK for iOS provides APIs for your iOS application built with Objective-C to access Mobile Backend Services (MBS).    </p>
    <div class="section section-2 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-GettingtheSDK">
        <h2 class="heading "><span>Getting the SDK</span></h2>
    <p>To download and start using the SDK, you first need to register a new iOS application in <a class="external-link external-link" href="https://platform.appcelerator.com/" target="_blank">Dashboard</a>. See <a class="document-link " href="#!/guide/Managing_Non-Titanium_Client_Applications_in_Dashboard">Managing Non-Titanium Client Applications in Dashboard</a> for details on registering a new application. After you register an application, a service key is generated that associates your application with all the Platform services. The Dashboard also provides full instructions for enabling all Platform Services in your application. This guide will deal specifically with enabling and using Mobile Backend Services in an iOS application.    </p>
    <p>    <img src="images/download/attachments/49153770/instrux.png" alt="images/download/attachments/49153770/instrux.png" class="confluence-embedded-image" width="500">
        </img></p>
    </div>
    <div class="section section-2 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-RunningtheAPSCloudExampleapplication">
        <h2 class="heading "><span>Running the APSCloud Example application</span></h2>
    <p>The SDK ZIP file includes an iOS sample project that demonstrates basic usage of each of the Cloud APIs. To run the sample, register a new application in Dashboard to obtain the necessary service application. You will then copy the key into the imported sample project&apos;s application delegate, then run the application.    </p>
    <p><strong class=" ">To create the APSCloudExample application in Dashboard:</strong>    </p>
<ol class=" "><li class=" ">    <p>Login to <a class="external-link external-link" href="https://platform.appcelerator.com/" target="_blank">Appcelerator Dashboard</a>.    </p>
</li><li class=" ">    <p>From the <strong class=" ">Orgs</strong> menu, select the organization to associate with the application. Note that the Orgs menu will not appear if you are not a member of multiple organizations.    </p>
</li><li class=" ">    <p>Click the <strong class=" ">Add</strong> menu (+) and select <strong class=" ">Register App for Services</strong>.    </p>
</li><li class=" ">    <p>In the dialog:    </p>
<ul class=" "><li class=" ">    <p>Enter <strong class=" ">APSCloudExampleApp</strong> (or another name) in the <strong class=" ">Name</strong> field.    </p>
</li><li class=" ">    <p>Select <strong class=" ">iOS</strong> from the <strong class=" ">Platform</strong> menu.    </p>
</li><li class=" ">    <p>Select any category from the <strong class=" ">Category</strong> menu.    </p>
    <img src="images/download/attachments/49153770/create_app.png" alt="images/download/attachments/49153770/create_app.png" class="confluence-embedded-image">
        <p>    </p>
</img></li></ul></li><li class=" ">    <p>Click <strong class=" ">Next</strong> and then click the <strong class=" ">Overview</strong> tab.    </p>
</li><li class=" ">    <p>Click the <strong class=" ">Services</strong> tab, then click <strong class=" ">Show Key</strong> under <strong class=" ">Cloud </strong>&gt;<strong class=" "> Performance </strong>&gt;<strong class=" "> Analytics</strong>.    </p>
</li><li class=" ">    <p>Select <strong class=" ">Development</strong> from the Environment menu, then click the clipboard icon to copy the key to your clipboard.    </p>
    <img src="images/download/attachments/49153770/copy_key.png" alt="images/download/attachments/49153770/copy_key.png" class="confluence-embedded-image">
        <p>    </p>
</img></li></ol>    <p>Next, import the APSCloudExample project into Xcode, copy the key from your clipboard into the application delegate, and run the application.    </p>
    <p><strong class=" ">To import the completed APSCloudExample project:</strong>    </p>
<ol class=" "><li class=" ">    <p>In Xcode, open the <strong class=" "><tt class=" ">appcelerator-sdk-ios-&lt;VERSION&gt;/examples/APSCloudExample.xcodeproj</tt></strong>.    </p>
</li><li class=" ">    <p>Open <strong class=" "><tt class=" ">AppDelegate.m</tt></strong>, add the code below to your application delegate&apos;s <tt class=" ">application:didFinishLaunchingWithOptions</tt> method, and replace <strong class=" ">&lt;&lt; YOUR APP KEY &gt;&gt;</strong> with the application key you copied to your clipboard previously.    </p>
    <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">[[APSServiceManager sharedInstance] enableWithAppKey:@</code><code class="string">&quot;&lt;&lt; YOUR APP KEY &gt;&gt;&quot;</code><code class="plain">];</code></div>
</div>
    </div>
</li><li class=" ">    <p>Run the application on an iOS device or simulator.    </p>
</li></ol>    <p>Once the application is running, try the following:    </p>
<ul class=" "><li class=" ">    <p>Create a new user by selecting <strong class=" ">Users </strong>&gt;<strong class=" "> Create User</strong>. Enter a username, password and password confirmation and then click <strong class=" ">Create</strong>. If the user is created successfully, the following dialog is shown:<br>    <img src="images/download/attachments/49153770/new_user_success.png" alt="images/download/attachments/49153770/new_user_success.png" class="confluence-embedded-image">
        </img></br></p>
</li><li class=" ">    <p>View the newly created user in Dashboard:    </p>
<ol class=" "><li class=" ">    <p>Open <a class="external-link external-link" href="https://platform.appcelerator.com/" target="_blank">Dashboard</a> and select your application from the Apps menu.    </p>
</li><li class=" ">    <p>Select <strong class=" ">Cloud &gt; Manage Data</strong>, then click <strong class=" ">Users</strong> in the Manage Data Object table. You should see the user you created listed in the Users table.    </p>
    <img src="images/download/attachments/49153770/verify_new_user.png" alt="images/download/attachments/49153770/verify_new_user.png" class="confluence-embedded-image" width="500">
        <p>    </p>
</img></li></ol></li></ul>    </div>
    <div class="section section-2 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-EnablingCloudservicesinanewproject">
        <h2 class="heading "><span>Enabling Cloud services in a new project</span></h2>
    <p>Once you&apos;ve <a class="external-link external-link" href="#!/guide/Managing_Non-Titanium_Client_Applications_in_Dashboard">registered an application in Dashboard</a>, downloaded the SDK, and obtained your application service key, there are few steps to enable Cloud services in your iOS project. The steps are slightly different if you are using Xcode 6 or 5.    </p>
    <p><strong class=" ">To enable the Cloud service in an existing Xcode project</strong>:    </p>
<ol class=" "><li class=" ">    <p>Add the <strong class=" "><tt class=" ">appcelerator-sdk-ios-&lt;VERSION&gt;/Appcelerator.framework</tt></strong> folder to your project:    </p>
<ul class=" "><li class=" ">    <p>For Xcode 5 projects, drag the <strong class=" ">Appcelerator.framework</strong> folder to your project&apos;s Frameworks folder, making sure <strong class=" ">Copy items into destination group&apos;s folder</strong> is checked, and click <strong class=" ">Finish</strong>.    </p>
</li><li class=" ">    <p>For Xcode 6 projects, drag the <strong class=" ">Appcelerator.framework</strong> folder to the project&apos;s root folder, making sure <strong class=" ">Copy Items if Needed</strong> is checked, and click <strong class=" ">Finish</strong>.    </p>
</li></ul></li><li class=" ">    <p>On your project&apos;s <strong class=" ">Build Phases</strong> tab, expand the <strong class=" ">Link Binary With Libraries</strong> section and add the <strong class=" ">libsqlite3.dylib</strong> and <strong class=" ">libz.dylib</strong> frameworks.    </p>
</li><li class=" ">    <p>On your project&apos;s <strong class=" ">Build Settings</strong> tab, click <strong class=" ">All</strong> in the top-left corner, then expand the <strong class=" ">Linking</strong> section.    </p>
</li><li class=" ">    <p>In the <strong class=" ">Other Linker Flags</strong> field, enter <strong class=" ">-ObjC</strong>.    </p>
    <img src="images/download/attachments/49153770/otherlinker.png" alt="images/download/attachments/49153770/otherlinker.png" class="confluence-embedded-image">
        <p>    </p>
</img></li><li class=" ">    <p>Import <tt class=" ">Appcelerator.h</tt> into your application delegate:    </p>
    <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="preprocessor">#import &lt;Appcelerator/Appcelerator.h&gt;</code></div>
</div>
    </div>
</li><li class=" ">    <p>Lastly, initialize Platform services by calling the <tt class=" ">[APSServiceManager enableWithAppKey]</tt> method, replacing <strong class=" ">&lt;&lt; YOUR APP KEY &gt;&gt;</strong> with the service key generated by Dashboard when you created your application. (See <a class="document-link " href="#!/guide/Managing_Non-Titanium_Client_Applications_in_Dashboard">View Application Information</a><a class="external-link external-link" href="http://docs.appcelerator.com/platform/redirects/aps_key.html" target="_blank"> for how to locate your application key.)</a>    </p>
    <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">[[APSServiceManager sharedInstance] enableWithAppKey:@</code><code class="string">&quot;&lt;&lt;YOUR APP KEY&gt;&gt;&quot;</code><code class="plain">];</code></div>
</div>
    </div>
</li></ol>    <p>At this point, your application can begin making API calls.    </p>
    </div>
    <div class="section section-2 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-MakingAPIcallsandhandlingresponses">
        <h2 class="heading "><span>Making API calls and handling responses</span></h2>
    <p>The iOS framework includes a collection of classes whose methods map to individual REST API method endpoints. For example, the <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSUsers.html#//api/name/create:withBlock:" target="_blank">APSUsers create</a> method corresponds to the <tt class=" ">/users/create.json</tt> method endpoint.    </p>
    <p>Alternatively, you can use the generic <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSCloud.html#//api/name/sendRequest:method:data:handler:" target="_blank">APSCloud sendRequest</a> method to make REST calls directly against the Cloud APIs. For more information, see <a class="document-link " href="#!/guide/AMPLIFY_Appcelerator_Platform_Services_SDK_for_iOS_Mobile_Backend_Services-section-src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-MakingGenericRESTAPIsMethodCalls">Making Generic REST API Calls</a>.    </p>
    <div class="section section-3 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Buildingrequestparameters">
        <h3 class="heading "><span>Building request parameters</span></h3>
    <p>The first parameter of each Cloud API method is a <tt class=" ">NSDictionary</tt> object that contains the of parameters to send with the request. For example, the <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSPhotos.html#//api/name/show:withBlock:" target="_blank">APSPhotos show</a> method takes a <tt class=" ">photo_id</tt> parameter whose value is, naturally, the ID of the photo to show.    </p>
    <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="comments">// Create dictionary of parameters to be passed with the request</code></div>
<div class="line"><code class="plain">NSDictionary *data = @{@</code><code class="string">&quot;photo_id&quot;</code><code class="plain">: self.photoId};</code></div>
<div class="line"><code class="plain">[APSPhotos show:data withBlock:^(APSResponse *e) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Handle response</code></div>
<div class="line"><code class="plain">}];</code></div>
</div>
    </div>
    </div>
    <div class="section section-3 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Handlingresponses">
        <h3 class="heading "><span>Handling responses</span></h3>
    <p>The second parameter of each method call is a block that is passed an <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSResponse.html" target="_blank">APSResponse</a> whose properties contain information about the response. For instance, the <tt class=" ">success</tt> property contains a boolean indicating if the method call was successful or not; the <tt class=" ">response</tt> property returns a JSON-encoded object with the results of the method call.    </p>
    <div class="tablewrap">
        <table>
        <thead class=" "/><tfoot class=" "/><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">NSDictionary *data = @{@</code><code class="string">&quot;photo_id&quot;</code><code class="plain">: self.photoId};</code></div>
<div class="line"><code class="plain">[APSPhotos show:data withBlock:^(APSResponse *e) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// The block will be called on the thread the request was started on</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (e.success) {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Remove the backslashes from URLs in the JSON</code></div>
<div class="line"><code class="plain">        self.textView.text = [e.responseString stringByReplacingOccurrencesOfString:@</code><code class="string">&quot;\\&quot;</code><code class="plain"> withString:@</code><code class="string">&quot;&quot;</code><code class="plain">];</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        [Utils handleErrorInResponse:e];</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}];</code></div>
</div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <p>Note that the block will be called on the thread that the request was started on.    </p>
    <div class="section section-4 " id="src-49153770_safe-id-QU1QTElGWUFwcGNlbGVyYXRvclBsYXRmb3JtU2VydmljZXNTREtmb3JpT1NNb2JpbGVCYWNrZW5kU2VydmljZXMtRXhhbXBsZTpBUFNVc2Vyc2xvZ2luY2FsbHdpdGhyZXNwb25zZWhhbmRsZXI">
        <h4 class="heading "><span>Example: APSUsers login call with response handler</span></h4>
    <p>The following example logs in an existing MBS user by their username and password. After a successful login, the application displays an alert indicating a successful login.    </p>
    <div class="tablewrap">
        <table>
        <thead class=" "/><tfoot class=" "/><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="comments">// Create dictionary of parameters to be passed with the request</code></div>
<div class="line"><code class="plain">NSDictionary *data = @{</code></div>
<div class="line"><code class="plain">   @</code><code class="string">&quot;login&quot;</code><code class="plain">: self.usernameField.text,</code></div>
<div class="line"><code class="plain">   @</code><code class="string">&quot;password&quot;</code><code class="plain">: self.passwordField.text</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line">&#xA0;</div>
<div class="line"><code class="plain">[APSUsers login:data withBlock:^(APSResponse *e) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// The block will be called on the thread the request was started on</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (e.success) {</code></div>
<div class="line"><code class="plain">        NSString *userId = [[[e.response objectForKey:@</code><code class="string">&quot;users&quot;</code><code class="plain">] objectAtIndex:0] objectForKey:@</code><code class="string">&quot;id&quot;</code><code class="plain">];</code></div>
<div class="line"><code class="plain">        NSString *msg = [NSString stringWithFormat:@</code><code class="string">&quot;Logged in! You are now logged in as %@&quot;</code><code class="plain">, userId];</code></div>
<div class="line"><code class="plain">        [[[UIAlertView alloc] initWithTitle:@</code><code class="string">&quot;Success&quot;</code><code class="plain"> message:msg delegate:nil cancelButtonTitle:@</code><code class="string">&quot;OK&quot;</code><code class="plain"> </code></div>
<div class="line"><code class="plain">        otherButtonTitles:nil] show];</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        [Utils handleErrorInResponse:e];</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}];</code></div>
</div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    </div>
    <div class="section section-3 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Monitoringrequestprogress">
        <h3 class="heading "><span>Monitoring request progress</span></h3>
    <p>For Cloud API methods that involve uploading large files, such as <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSPhotos.html#//api/name/create:withBlock:progressBlock:" target="_blank">APSPhotos create</a> or APSFiles create, there is an overloaded version that takes an additional <tt class=" ">progressBlock</tt> parameter. This parameter is a code block that is periodically invoked and passed a float value indicating the progress of the request, and a boolean indicating if the request is for an upload (YES) or download (NO).    </p>
    <div class="section section-4 " id="src-49153770_safe-id-QU1QTElGWUFwcGNlbGVyYXRvclBsYXRmb3JtU2VydmljZXNTREtmb3JpT1NNb2JpbGVCYWNrZW5kU2VydmljZXMtRXhhbXBsZTpBUFNQaG90b3NjcmVhdGVjYWxsd2l0aHByb2dyZXNzaGFuZGxlcg">
        <h4 class="heading "><span>Example: APSPhotos create call with progress handler</span></h4>
    <p>The following example creates a new Photo object from a binary photo attachment. The <tt class=" ">progressBlock</tt> code block sets the <tt class=" ">progress</tt> property on a <tt class=" ">ProgressBar</tt> object, displaying the status of the upload.    </p>
    <div class="tablewrap">
        <table>
        <thead class=" "/><tfoot class=" "/><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">NSDictionary *data = @{</code></div>
<div class="line"><code class="plain">    @</code><code class="string">&quot;photo&quot;</code><code class="plain">: self.photoData,</code></div>
<div class="line"><code class="plain">    @</code><code class="string">&quot;photo_sync_sizes[]&quot;</code><code class="plain">: @</code><code class="string">&quot;small_240&quot;</code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"><code class="plain">[APSPhotos create:data withBlock:^(APSResponse *e) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// The block will be called on the thread the request was started on</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (e.success) {</code></div>
<div class="line"><code class="plain">        [[[UIAlertView alloc] initWithTitle:@</code><code class="string">&quot;Success&quot;</code><code class="plain"> message:@</code><code class="string">&quot;Uploaded!&quot;</code><code class="plain"> delegate:nil cancelButtonTitle:@</code><code class="string">&quot;OK&quot;</code><code class="plain"> </code></div>
<div class="line"><code class="plain">        otherButtonTitles:nil] show];</code></div>
<div class="line"><code class="plain">        self.photoData = nil;</code></div>
<div class="line"><code class="plain">    } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">        [Utils handleErrorInResponse:e];</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    self.createButton.hidden = NO;</code></div>
<div class="line"><code class="plain">} progressBlock:^(float progress, BOOL upload) {</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// The block will be called on the thread the request was started on</code></div>
<div class="line"><code class="plain">    self.progressBar.progress = progress;</code></div>
<div class="line"><code class="plain">}];</code></div>
</div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    </div>
    </div>
    <div class="section section-2 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-MakinggenericRESTAPIsmethodcalls">
        <h2 class="heading "><span>Making generic REST APIs method calls</span></h2>
    <p>The <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSCloud.html#//api/name/sendRequest:method:data:handler:" target="_blank">APSCloud sendRequest</a> method lets you easily make REST API calls directly against MBS, rather than using the specialized classes. In general, you should use the specialized classes as they provide an easier API. However, if new REST methods are deployed to the APS Cloud backend, this approach lets you immediately start using those methods without waiting for an update to the SDK.    </p>
    <p>To make a generic request, you call <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSCloud.html#//api/name/sharedInstance" target="_blank">APSCloud sharedInstance</a> to get a reference to the shared APSCloud object and then call its <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSCloud.html#//api/name/sendRequest:method:data:handler:" target="_blank">sendRequest</a> method. For each call, you must specify the following:    </p>
<ul class=" "><li class=" ">    <p>REST API method endpoint relative to &quot;api.cloud.appcelerator.com/v1&quot;. Method endpoints are listed in the corresponding entries in the <a class="external-link external-link" href="/arrowdb/latest/#!/api">REST API documentation</a>.    </p>
</li><li class=" ">    <p>The HTTP method to use.    </p>
</li><li class=" ">    <p>Data to send with the request.    </p>
</li></ul>    <p>For example, to <a class="external-link external-link" href="/arrowdb/latest/#!/api/Posts-method-create">create a post</a>, pass the <tt class=" ">sendRequest()</tt> method the following information:    </p>
<ul class=" "><li class=" ">    <p>REST API method endpoint: <tt class=" ">posts/create.json</tt>    </p>
</li><li class=" ">    <p>The HTTP method to use: <tt class=" ">POST</tt>    </p>
</li><li class=" ">    <p>Data to send with the request: at a minimum, you must specify the <tt class=" ">content</tt> property.    </p>
</li></ul>    <p>The following example calls <tt class=" ">users/login.json</tt> REST method directly and logs the result to the console.    </p>
    <div class="tablewrap">
        <table>
        <thead class=" "/><tfoot class=" "/><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">NSDictionary *data = [NSDictionary dictionaryWithObjectsAndKeys:</code></div>
<div class="line"><code class="plain">                                    @</code><code class="string">&quot;jalter&quot;</code><code class="plain">, @</code><code class="string">&quot;login&quot;</code><code class="plain">,</code></div>
<div class="line"><code class="plain">                                    @</code><code class="string">&quot;pass&quot;</code><code class="plain">, @</code><code class="string">&quot;password&quot;</code><code class="plain">,</code></div>
<div class="line"><code class="plain">                                    nil];</code></div>
<div class="line"><code class="plain">[[APSCloud sharedInstance] sendRequest:@</code><code class="string">&quot;users/login.json&quot;</code><code class="plain"> method:@</code><code class="string">&quot;POST&quot;</code><code class="plain"> data:datahandler:^(APSResponse *e) {</code></div>
<div class="line"><code class="plain">    NSLog(@</code><code class="string">&quot;SUCCESS: %hhd&quot;</code><code class="plain">, e.success);</code></div>
<div class="line"><code class="plain">    NSLog(@</code><code class="string">&quot;ERROR: %hhd&quot;</code><code class="plain">, e.error);</code></div>
<div class="line"><code class="plain">    NSLog(@</code><code class="string">&quot;MESSAGE: %@&quot;</code><code class="plain">, e.message);</code></div>
<div class="line"><code class="plain">}];</code></div>
</div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2 " id="src-49153770_AMPLIFYAppceleratorPlatformServicesSDKforiOSMobileBackendServices-Workingwithpushnotifications">
        <h2 class="heading "><span>Working with push notifications</span></h2>
    <p>The <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSPushNotifications.html" target="_blank"><tt class=" ">APSPushNotifications</tt></a> class lets your application subscribe, send, and receive push notifications. To use the class:    </p>
<ul class=" "><li class=" ">    <p><a class="document-link " href="#!/guide/Configuring_push_services">Configure push notification services</a> for your application.    </p>
</li><li class=" ">    <p><a class="external-link external-link" href="https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW2" target="_blank">Register your application</a> to obtain the necessary device token.    </p>
</li></ul>    <p>Once push services have been configured, the application needs to register with iOS to receive push notifications. For example, you can add the following code to the application delegate implementation file in the <tt class=" ">application:didFinishLaunchingWithOptions:</tt> method:    </p>
    <div class="tablewrap">
        <table>
        <thead class=" "/><tfoot class=" "/><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {</code></div>
<div class="line"><code class="plain">    [[APSServiceManager sharedInstance] enableWithAppKey:@</code><code class="string">&quot;APS_APP_KEY&quot;</code><code class="plain">];</code></div>
<div class="line">&#xA0;</div>
<div class="line"><code class="plain">    </code><code class="comments">// Add this code to register for remote notifications</code></div>
<div class="line"><code class="plain">    UIUserNotificationType types = UIUserNotificationTypeBadge |</code></div>
<div class="line"><code class="plain">    UIUserNotificationTypeSound | UIUserNotificationTypeAlert;</code></div>
<div class="line">&#xA0;</div>
<div class="line"><code class="plain">    UIUserNotificationSettings *mySettings =</code></div>
<div class="line"><code class="plain">    [UIUserNotificationSettings settingsForTypes:types categories:nil];</code></div>
<div class="line">&#xA0;</div>
<div class="line"><code class="plain">    [[UIApplication sharedApplication] registerUserNotificationSettings:mySettings];</code></div>
<div class="line"><code class="plain">    [[UIApplication sharedApplication] registerForRemoteNotifications];</code></div>
<div class="line">&#xA0;</div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> YES;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <p>After the application registers with iOS to receive push notifications, the application needs to register the device with Appcelerator Cloud. Call the <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSPushNotifications.html#//api/name/subscribe:withBlock:" target="_blank">subscribe</a> or <a class="external-link external-link" href="http://docs.appcelerator.com/aps-sdk-apidoc/latest/ios/Classes/APSPushNotifications.html#//api/name/subscribeToken:withBlock:" target="_blank">subscribeToken</a> method inside the application delegate&apos;s <tt class=" ">application:didRegisterForRemoteNotificationsWithDeviceToken:</tt> method. Note that you will need to convert the NSData parameter to a hex string before passing it to either the <tt class=" ">subscribe</tt> or <tt class=" ">subscribeToken</tt> method.    </p>
    <div class="tablewrap">
        <table>
        <thead class=" "/><tfoot class=" "/><tbody class=" ">    <tr>
            <td rowspan="1" colspan="1">
        <div class="confbox programlisting defaultnew syntaxhighlighter scroll-html-formatted-code">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">- (void)application:(UIApplication *)app</code></div>
<div class="line"><code class="plain">  didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)devToken {</code></div>
<div class="line">&#xA0;</div>
<div class="line"><code class="plain">    </code><code class="comments">// Convert the token to a string</code></div>
<div class="line"><code class="plain">    const unsigned *tokenBytes = [devToken bytes];</code></div>
<div class="line"><code class="plain">    NSString *hexToken = [NSString stringWithFormat:@</code><code class="string">&quot;%08x%08x%08x%08x%08x%08x%08x%08x&quot;</code><code class="plain">,</code></div>
<div class="line"><code class="plain">                          ntohl(tokenBytes[0]), ntohl(tokenBytes[1]), ntohl(tokenBytes[2]),</code></div>
<div class="line"><code class="plain">                          ntohl(tokenBytes[3]), ntohl(tokenBytes[4]), ntohl(tokenBytes[5]),</code></div>
<div class="line"><code class="plain">                          ntohl(tokenBytes[6]), ntohl(tokenBytes[7])];</code></div>
<div class="line">&#xA0;</div>
<div class="line"><code class="plain">    NSDictionary *subscribeData = @{</code></div>
<div class="line"><code class="plain">                                    @</code><code class="string">&quot;device_token&quot;</code><code class="plain">: hexToken,</code></div>
<div class="line"><code class="plain">                                    @</code><code class="string">&quot;channel&quot;</code><code class="plain">: @</code><code class="string">&quot;friend_channel&quot;</code><code class="plain">,</code></div>
<div class="line"><code class="plain">                                    @</code><code class="string">&quot;type&quot;</code><code class="plain">: @</code><code class="string">&quot;ios&quot;</code></div>
<div class="line"><code class="plain">                                    };</code></div>
<div class="line"><code class="plain">    [APSPushNotifications subscribeToken:subscribeData withBlock:^(APSResponse *e) {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (e.success) {</code></div>
<div class="line"><code class="plain">            NSLog(@</code><code class="string">&quot;Successfully subscribed to push: %@&quot;</code><code class="plain">, e.responseString);</code></div>
<div class="line"><code class="plain">        } </code><code class="keyword">else</code><code class="plain"> {</code></div>
<div class="line"><code class="plain">            NSLog(@</code><code class="string">&quot;Error in registration. Error: %@&quot;</code><code class="plain">, e.errorMessage);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }];</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <p>Once push services have been configured, and you&apos;ve obtained a device token by registering your application to receive remote notifications, you can start calling methods of the <tt class=" ">APSPushNotifications</tt> class.    </p>
    </div>
        </div><a id="editButton" href="https://wiki.appcelerator.org/pages/editpage.action?pageId=49153770"><span>Edit</span></a>
    
        
    </div>
</body>
</html>
